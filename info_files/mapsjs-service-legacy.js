
/**
 * The code below uses open source software. Please visit the URL below for an overview of the licenses:
 * http://js.api.here.com/v3/3.1.30.3/HERE_NOTICE
 */

H.service.util.eval("function is(a){var b;if(a)for(this.a={},b=a.length;b--;)this.a[a[b]]=!0;this.Hl={}}var js;is.prototype.a={};is.prototype.parse=function(a,b,c){var d,e,f,g,h;js=!1;try{c=Kp.JSON.parse(c)}catch(m){js=!0}if(c&&(d=c.metadata)){var k={spatials:[]};for(e in d){if(c=!this.a[e]&&(f=ks[e]))(g=d[e])||(js=!0,g=void 0),c=g;if(c)for(c=g.length;c--;){var l;(l=g[c])||(js=!0,l=void 0);(h=l)&&f(b,a,this,e,h,k)}}}else js=!0;return js?void 0:k};is.prototype.parse=is.prototype.parse;\nvar ks={\"street labels\":function(a,b,c,d,e,f){var g;(g=e.vertices)||(js=!0,g=void 0);if(g){var h,k=g.length,l;(l=0<k)||(js=!0,l=void 0);if(l)for(h=Array(k/2);k;){var m=g[--k];l=g[--k];h[k/2]=new I(l,m)}h=h?{a:[h]}:B;k=+e[\"font size\"]/a.$a();g=c.Hl[k];g||(ls.lineWidth=k,g=c.Hl[k]=c.Sd.Rj(ls));ms(a,b,h,!1,g,e,d,f)}delete e.vertices},\"city center labels\":function(a,b,c,d,e,f){ms(a,b,ns(e,new rh([])),!0,c.Sd,e,d,f)},labels:function(a,b,c,d,e,f){var g;(g=e[\"bounding boxes\"])||(js=!0,g=void 0);if(g){for(var h=\ng.length,k=new rh([]),l;h--;){var m;(m=g[h])||(js=!0,m=void 0);(l=m)&&ns(l,k)}ms(a,b,k,!0,c.Sd,e,d,f)}delete e[\"bounding boxes\"]},buildings:function(a,b,c,d,e,f){var g=e.id,h=b.zg[g],k,l,m,p=[],q=[];(k=e)||(js=!0,k=void 0);if(k&&((l=k.vertices)||(js=!0,l=void 0),l)){var r;(r=k.polygons)||(js=!0,r=void 0);(m=r)&&p.push.apply(p,os(l,m));(k=k.outlines)||(js=!0,k=void 0);(m=k)&&q.push.apply(q,os(l,m))}m=p.length;p.push.apply(p,q);q=new rh(p,Td,m);(p=p.length)||(js=!0,p=void 0);p&&(h?(Yq(h,a,[q]),f.spatials.push(h)):\n(h=ms(a,b,q,!0,c.Sd,e,d,f,g),b.ea(h)))}};ks[\"transit stops\"]=ks.POIs=ks.labels;var ps=[\"box 2\",\"box 1\",\"annotation box\",\"icon box\"];function ns(a,b){for(var c=ps.length,d,e;c--;)if(d=ps[c],e=a[d]){var f=e[0],g=e[1],h=e[2];e=e[3];b.a.push([new I(f,g),new I(f+h,g),new I(f+h,g+e),new I(f,g+e)]);delete a[d]}return b}\nfunction os(a,b){var c=b.length,d,e,f;if(0<c)for(e=Array(c);c--;)if((d=b[c])||(js=!0,d=void 0),d){var g=d.length;if(0<g)for(e[c]=f=Array(g);g--;){var h=2*d[g];f[g]=new I(a[h],a[h+1])}}return e||[]}var qs={};function ms(a,b,c,d,e,f,g,h,k){qs.style=e;d=new Uq(b,d,k,qs);c&&Yq(d,a,[c]);rs(f);f.category=g;d.setData(f);h.spatials.push(d);d.ka(b);return d}is.prototype.Sd=new Ug({strokeColor:\"transparent\",fillColor:\"transparent\",lineWidth:0});var ls={};\nfunction rs(a){var b,c=!1;switch(typeof a){case \"object\":if(a instanceof Array)for(b=a.length;b--;)rs(a[b])?c=!0:delete a[b];else if(a)for(b in a)rs(a[b])?c=!0:delete a[b];break;case \"number\":c=!0;break;default:c=!!a}return c};function ss(a,b,c){c=c||{};b=b||{};var d=c.tileType||\"maptile\",e=c.scheme||\"normal.day\";R.call(this,{min:0,max:20});!0===b.pois&&(b.pois=\"!F\");this.a=b;if(!(a&&a instanceof ts))throw Error(\"InvalidArgument: service required\");this.C=a;this.v=A(this.v,this);this.C.addEventListener(\"versionupdate\",this.v);this.c=a.D().clone().F(d+\"/\"+a.Cc()+\"/\"+e).I(this.N).I(b);this.bc=a.Fh()||null;this.W=c.pixelRatio||c.pixelratio||Se();this.tileSize=c.tileSize||256;this.tileType=d;this.scheme=e;this.s=new kq(new is(c.categoryFilter));\nthis.s.ka(this);this.J=A(this.J,this);this.s.addEventListener(\"update\",this.J);R.call(this,{min:0,max:20});this.O(new Dk(c.tileCacheSize||256,A(this.Aa,this)))}u(ss,R);t(\"H.service.metaInfo.TileProvider\",ss);ss.prototype.Aa=function(a,b){a=b.Va();for(var c=a.length,d;c--;)d=a[c],delete d.tf[b.key],d.release();b.data&&(Mp.push(b.xg(),this.tileSize),b.yg())};ss.prototype.J=function(){this.dispatchEvent(\"update\")};\nss.prototype.K=function(a,b,c,d,e){var f=this.c.clone(),g=this.bc,h=this.tileSize,k=this.getTileKey(a,b,c);k=this.Ob().get(k);var l;if(k&&!k.le()){d(Mp.pop(this.tileSize),null);var m={cancel:function(){}}}else{g&&f.Ma(g[(c+b+a)%g.length]);f.F(c+\"/\"+a+\"/\"+b+\"/\"+h+\"/png8\");var p=Kp.setTimeout(function(){l=new rf(\"text/plain\",f.toString());l.then(function(q){d(null,q)},e)},500)}return m||{cancel:function(){l?l.cancel():Kp.clearTimeout(p)}}};ss.prototype.requestInternal=ss.prototype.K;\nss.prototype.rd=function(a,b,c,d,e){var f=this.s;var g=d||Mp.pop(this.tileSize);if(d)a=this.Ob().get(this.getTileKey(a,b,c)),a.V(d);else if(d=a=new Pk(this.yd(a,b,c),a,b,c,this.tileSize,this.W,c,f),delete d.j,d.m=e,a.V(g))for(e=a.Va(),g=e.length;g--;)e[g].Dg();else Mp.push(g,this.tileSize);return a};ss.prototype.createTileInternal=ss.prototype.rd;ss.prototype.B=function(){this.s.B();this.C.removeEventListener(\"versionupdate\",this.v);R.prototype.B.call(this)};\nss.prototype.v=function(){var a=this.C;this.c=a.D().clone().F(this.tileType+\"/\"+a.Cc()+\"/\"+this.scheme).I(this.N).I(this.a);this.reload(!1)};ss.prototype.N={metadata:\"metaonly\",mgen:\"2\"};function ts(a){ts.l.constructor.call(this,ts,a);a=Qp(this,a);this.bc=a.shards;(this.Ra=a.ignoreTypes?null:a.type)&&this.D().Ma(this.Ra);this.cc=a.version;this.vi={};this.Xc=new Ap;\"newest\"===this.cc&&this.ph()}u(ts,Pp);t(\"H.service.metaInfo.Service\",ts);ts.prototype.a=function(){return{type:\"base\",version:\"newest\",subDomain:\"maps.ls\",path:\"maptile/2.1\",shards:[\"1\",\"2\",\"3\",\"4\"]}};ts.CONFIG_KEY=\"metaInfo\";function us(a,b){for(var c={},d=a[b+\"s\"][b],e=d.length;e--;)c[d[e].id]=d[e];a[b+\"s\"]=c}\nts.prototype.Fh=function(){return this.bc};ts.prototype.ek=function(){return this.Ra};ts.prototype.Cc=function(){return this.cc};ts.prototype.getVersion=ts.prototype.Cc;ts.prototype.Si=function(a){this.cc=a};ts.prototype.ta=function(){return this.Xc};ts.prototype.getCopyrights=ts.prototype.ta;\nts.prototype.$i=function(a){a=a.response;var b;us(a,\"map\");us(a,\"scheme\");us(a,\"tiletype\");us(a,\"format\");us(a,\"resolution\");us(a,\"language\");if(\"newest\"===this.cc&&\"traffic\"!==this.Ra)for(b in a.maps)a.maps[b].hash&&a.maps[b].newest&&(this.Si(a.maps[b].hash),this.dispatchEvent(\"versionupdate\"));this.Lh=a;this.dispatchEvent(\"infoupdate\")};\nts.prototype.ph=function(){var a=this;var b=this.D().clone().F(\"info\").I({output:\"json\"});this.bc&&b.Ma(this.bc[0]);this.K(b,function(c){a.$i(c)},function(c){throw c;})};ts.prototype.xh=function(){return this.Lh};ts.prototype.getInfo=ts.prototype.xh;ts.prototype.Me=function(a,b,c,d,e,f){return new ss(this,d,{tileSize:a,pixelRatio:b,categoryFilter:c,tileType:e,scheme:f})};ts.prototype.createTileProvider=ts.prototype.Me;ts.prototype.wc=function(a,b,c,d,e,f){return new ll(this.Me(a,b,c,d,e,f))};\nts.prototype.createTileLayer=ts.prototype.wc;Y.prototype.Wj=function(a){return this.Ya(ts,a)};Y.prototype.getMetaInfoService=Y.prototype.Wj;(function(){var a=Y.prototype.createDefaultLayers;Y.prototype.createDefaultLayers=function(b,c,d,e,f,g){var h=a.call(this,b,c,d,e,f,g),k={},l=this.Wj();\"object\"===typeof b&&(g=b,b=g.tileSize,c=g.ppi,d=g.lg,e=g.lg2,f=g.style,g=g.pois);b=b||256;var m=320===c?2:1;if(0>[72,250,320,500].indexOf(+c)){if(c!==B)throw new D(this.Sf,1,c);}else k.ppi=+c;d&&(k.lg=d);e&&(k.lg2=e);f&&(k.style=f);g&&(k.pois=g);h.raster.normal.metaInfo=l.wc(b,m,[\"buildings\"],k);return h}})();\n");